\chapter{Gramatyka}

W tym rozdziale przedstawimy gramatykę zaprojektowanego przez nas języka. W pierwszej części pokażemy strukturę leksykalną TQL, czyli elementy, z których buduje się zapytania. W drugiej części zaprezentujemy reguły tworzenia zapytań, zapisane w formie reguł gramatyki w notacji BNF.

\section{Struktura leksykalna}
\subsection{Literały}

\subsubsection{String}
Literał \terminal{String}\ jest ciągiem dowolnych znaków w cudzysłowiu (\texttt{"}). Nie może zawierać jedynie znaków 
``\texttt{"}`` niepoprzedzonych ''\verb6\6``.

% ma postać
% \terminal{"}$x$\terminal{"}, gdzie $x$ jest dowolnym ciągiem znaków
% poza \terminal{"}\ niepoprzedzonymi \verb6\6.


\subsubsection{SłowoOdLitery}
Literał \terminal{SłowoOdLitery} to ciąg liter, cyfr oraz znaków  {''\texttt{-}``, ''\texttt{'}``, ''\texttt{\_}``}, zaczynający się od litery,
z wyjątkiem słów kluczowych.



\subsubsection{SłowoOdLiczby}
Literał \terminal{SłowoOdLiczby} to ciąg liter, cyfr oraz znaków  {''\texttt{-}``, ''\texttt{'}``, ''\texttt{\_}``}, zaczynający się od cyfry.


\subsection{Słowa kluczowe}
\begin{tabular}{lll}
{\reserved{as}} &{\reserved{define}} &{\reserved{in}} \\
{\reserved{search}} & & \\
\end{tabular}\\

\subsection{Znaki specjalne}
\begin{tabular}{lll}
{\symb{(}} &{\symb{)}} &{\symb{{$+$}}} \\
{\symb{/}} &{\symb{{$-$}{$-$}}} &{\symb{*}} \\
{\symb{:}} & &{\symb{$\backslash$n}} (koniec linii)\\
\end{tabular}\\

% \subsection{Komentarze}
% %TODO: komentarze??
% W chwili obecnej język nie zawiera komentarzy.

\section{Struktura składniowa języka}
Nieterminale są pomiędzy ''$\langle$`` a ''$\rangle$``. 
Symbole  ''{\arrow}``  (produkcja),  ''{\delimit}``  (lub) 
i ''{\emptyP}`` (pusta reguła) należą do notacji BNF. 
Wszystkie pozostałe symbole to terminale.\\

\begin{tabular}{lll}
{\nonterminal{Zapytanie Złożone}} & {\arrow}  &{\nonterminal{Lista Zapytań}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Lista Zapytań}} & {\arrow}  &{\nonterminal{Zapytanie}}  \\
 & {\delimit}  &{\nonterminal{Zapytanie}} {\nonterminal{Lista Zapytań}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Zapytanie}} & {\arrow}  &{\nonterminal{Lista Linii Zapytania}} {\nonterminal{Lista Pustych Linii}}  \\
 & {\delimit}  &{\terminal{define}} {\terminal{$\backslash$n}} {\nonterminal{Zapytanie}} {\terminal{as}} {\nonterminal{Nazwa}} {\nonterminal{Lista Pustych Linii}}  \\
 & {\delimit}  &{\terminal{search}} {\terminal{$\backslash$n}} {\nonterminal{Zapytanie}} {\terminal{in}} {\nonterminal{Nazwa}} {\nonterminal{Lista Pustych Linii}}  \\
  & {\delimit}  &{\terminal{search}} {\nonterminal{Nazwa}} {\nonterminal{Lista Pustych Linii}}  \\
 & {\delimit}  &{\nonterminal{Lista Pustych Linii}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Lista Linii Zapytania}} & {\arrow}  &{\nonterminal{Linia Zapytania}} {\terminal{$\backslash$n}}  \\
 & {\delimit}  &{\nonterminal{Linia Zapytania}} {\terminal{$\backslash$n}} {\nonterminal{Lista Linii Zapytania}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Linia Zapytania}} & {\arrow}  &{\nonterminal{Nazwa pola}} {\terminal{:}} {\nonterminal{Wyrażenie}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Wyrażenie}} & {\arrow}  &{\nonterminal{Wyrażenie}} {\terminal{{$+$}}} {\nonterminal{Wyrażenie1}}  \\
 & {\delimit}  &{\nonterminal{Wyrażenie}} {\terminal{/}} {\nonterminal{Wyrażenie1}}  \\
 & {\delimit}  &{\nonterminal{Wyrażenie1}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Wyrażenie1}} & {\arrow}  &{\terminal{{$-$}{$-$}}} {\nonterminal{Wyrażenie1}}  \\
 & {\delimit}  &{\nonterminal{Wyrażenie2}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Wyrażenie2}} & {\arrow}  &{\nonterminal{Wyrażenie3}} {\terminal{*}} {\nonterminal{Wyrażenie3}}  \\
 & {\delimit}  &{\nonterminal{Tekst}}  \\
 & {\delimit}  &{\terminal{(}} {\nonterminal{Wyrażenie}} {\terminal{)}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Wyrażenie3}} & {\arrow}  &{\nonterminal{Wyrażenie2}}\\
 & {\delimit}  &{\emptyP} \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Lista Pustych Linii}} & {\arrow}  &{\emptyP} \\
 & {\delimit}  &{\nonterminal{Pusta Linia}} {\nonterminal{Lista Pustych Linii}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Pusta Linia}} & {\arrow}  &{\terminal{$\backslash$n}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Tekst}} & {\arrow}  &{\terminal{String}}  \\
 & {\delimit}  &{\nonterminal{Słowo}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Słowo}} & {\arrow}  &{\terminal{SłowoOdLitery}}  \\
 & {\delimit}  &{\terminal{SłowoOdLiczby}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Nazwa pola}} & {\arrow}  &{\terminal{SłowoOdLitery}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Nazwa}} & {\arrow}  &{\terminal{String}}  \\
\end{tabular}\\

Powyższa gramatyka może jest gramatyką bezkontekstową. 

\chapter{Semantyka}
%możliwe pola
%W zapytaniu TQL można pytać o następujące dane:
Język TQL umożliwia wyszukiwanie na podstawie kryteriów dotyczących następujących danych:
\begin{longtable}{|p{3in}|p{3in}|}
\hline
{\bf Opis} & {\bf Nazwa pola w TQL}\\
\hline
\endhead
numer tabliczki w bazie CDLI & cdli\_id
\\
\hline
miejsce pochodzenia (proweniencja) & provenience
\\
\hline
okres powstania & period
\\
\hline
typ i podtyp & genre
\\
\hline
rok powstania & year 
\\
\hline
publikacja & publication
\\
\hline
treść (odczyty)& text
\\
\hline
treść (kliny) & cunetext
\\
\hline
kolekcja & collection
\\
\hline
muzeum & museum
\\
\hline
\end{longtable}
% \item kliny 
% \item treść na pieczęci (seal)
%  \item kod tematyczny (code)
% "provenience", "publication", "period", "year", "genre", "code", "cdli_id", "text", "seal"
Język można łatwo rozszerzać, aby umożliwić tworzenie kryteriów wyszukiwania w oparciu o inne dane (np. zawartość pieczęci).

%Semantykę przedstawimy na wybranych przykładach. 
Poniżej przedstawiamy semantykę wybranych przykładów.
\section{Zapytanie proste}
\begin{verbatim}
provenience: Gar*
period: "Ur III"
genre: Administrative
text: udu + (masz2/ugula) --szabra
\end{verbatim}
Wynikiem zapytania będą wszystkie tabliczki, które:
\begin{itemize}
 \item pochodzą z miejscowości o nazwie zaczynającej się na ``Gar''
\item pochodzą z okresu Ur III
\item są dokumentami administracyjnymi
\item zawierają słowo ``udu'' oraz conajmniej jedno ze słów ``masz2'' lub ``ugula''
\item nie zawierają słowa ``szabra''
\end{itemize}


\section{Zapytanie złożone}
\begin{verbatim}
provenience: Ur
period: "Ur III"/"Ur IV"
text: udu --szabra

text: masz2/ugula
publication: *tan
provenience: Ur
\end{verbatim}
Wynikiem zapytania będą wszystkie tabliczki, które:
\begin{itemize}
 \item pochodzą z miejscowości Ur
 \item pochodzą z okresu Ur III lub Ur IV
 \item zawierają słowo ``udu''
 \item nie zawierają słowa ``szabra``
\end{itemize}
oraz wszystkie tabliczki, które:
\begin{itemize}
 \item zawierają słowo ''masz2`` lub ''ugula``
 \item zostały opublikowane w pracy, której nazwa kończy się na ''tan``
 \item pochodzą z miejscowości Ur
\end{itemize}


\section{Zapytanie zdefiniowane}
\begin{verbatim}
 define
  provenience: Gar*a
  period: Ur III
  text: "udu ban"/mash2
as "zwierzęta w Gar*a"
\end{verbatim}
Wynikiem zapytania (po jego wywołaniu) będą wszystkie tabliczki, które:
\begin{itemize}
\item pochodzą z miejscowości, których nazwy zaczynają się na ''Gar`` i kończą na ''a''
\item pochodzą z okresu Ur III
\item zawierają conajmniej jedną z fraz ''udu ban`` lub ''mash2``
\end{itemize}

\section{Wywołanie zapytania zdefiniowanego}
\subsection{Zwykłe}
\begin{verbatim}
search "zwierzęta w Gar*a"
\end{verbatim}
Wynikiem zapytania będą dokładnie te tabliczki, które spełniają wszystkie warunki zapytania ''zwierzęta w Gar*a``.
\subsection{Z dodatkowym warunkiem wyszukiwania}
\begin{verbatim}
search
  text: adad-tilati
in "zwierzęta w Gar*a"
\end{verbatim}
Wynikiem zapytania będą wszystkie tabliczki, które:
\begin{itemize}
 \item spełniają wszystkie warunki zapytania ''zwierzęta w Gar*a``
\item zawierają słowo ''adad-tilati``
\end{itemize}

