SELECT *
FROM
(
SELECT id_tab, array_accum(wezly), COUNT(DISTINCT id_sekw) as sekw
FROM (
select 
	o1.wezel1_id % 1000000 as id_tab, 
	'{' || o1.wezel1_id || ',' || o2.wezel2_id || '}'as wezly, 
	'a' as id_sekw
from 
	odczyty o1 
	left join odczyty o2 on (o1.wezel2_id = o2.wezel1_id) 
where
	(o1.wartosc = '#unknown' and o2.wartosc = '@text_end')
UNION
select 
	o1.wezel1_id % 1000000 as id_tab, 
	'{' || o1.wezel1_id || ',' || o2.wezel2_id || '}'as wezly, 
	'b' as id_sekw
from 
	odczyty o1 
	left join odczyty o2 on (o1.wezel2_id = o2.wezel1_id) 
where
	(o1.wartosc = '@text_begin' and o2.wartosc = '@obverse')	
) as a
GROUP BY id_tab
) as b
where b.sekw=2

select id, NULL AS wezly, 1 AS id
select 
MINUS
select id from tabliczka
where id not in(
  SELECT 
   o1.wezel1_id % 1000000 AS id_tab, 
    '{' || o1.wezel1_id || ',' || o2.wezel2_id || '}'AS wezly, 
	   1 AS id_sekw
  FROM 
    odczyty o1 
    LEFT JOIN odczyty o2 ON (o1.wezel2_id = o2.wezel1_id) 
  WHERE
    (
    o1.wartosc LIKE '#unknown'
    AND
    o2.wartosc LIKE '@text_end'
    )
) AS a GROUP BY id_tab) 
 AS sekwencja ON sekwencja.tab_id = t.id
)